<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RideKada - Home</title>
  <link rel="stylesheet" href="css/home.css">
</head>
<body>

  <!-- Navigation -->
  <nav class="navbar">
  <div class="logo-section">
    <img src="media/logo.png" alt="RideKada Logo" class="logo-circle">
    <span class="brand-name">RideKada</span>
  </div>

    <div class="user-section">
      <!-- My Bookings Button -->
      <button class="bookings-btn" onclick="window.location.href='my_bookings.html'">
        ðŸ“‹ My Bookings
      </button>

  

      <!-- PROFILE BUTTON + DROPDOWN -->
      <div class="profile-wrapper">
        <div id="userIcon" class="user-icon">ðŸ‘¤</div>

        <div id="profileDropdown" class="profile-dropdown">
          <a href="profile.html" class="dropdown-item">View Profile</a>
          <a href="#" id="logoutLink" class="dropdown-item">Logout</a>
        </div>
      </div>
    </div>
  </nav>

<!-- Banner Section -->
<div class="banner">
  <img src="media/mtrd.jpg" alt="Banner Image">
</div>

  <!-- Announcements Section -->
  <div class="announcements-banner" id="announcementsBanner" style="display: none;">
    <div class="announcements-container">
      <div class="announcements-header">
        <span class="announcement-icon">ðŸ“¢</span>
        <h3>Announcements</h3>
        <button class="close-announcements" onclick="closeAnnouncements()">Ã—</button>
      </div>
      <div class="announcements-content" id="announcementsContent">
        <!-- Populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Search Section -->
  <div class="search-section">
    <form action="php/driver_search.php" method="POST" class="search-container">
      
      <input type="text"
             class="search-input fixed-input"
             name="fromLocation"
             value="Maryheights"
             readonly
             title="Origin is fixed to Maryheights">

      <!-- Going To -->
      <input type="text"
             id="goingTo"
             class="search-input"
             name="goingTo"
             placeholder="Going to"
             required>

      <!-- Date (Auto-filled with today) -->
      <input type="date"
             id="calendar"
             class="search-input"
             name="calendar"
             required>

      <!-- Passenger Count -->
      <input type="number"
             id="passengerCount"
             class="search-input"
             name="passengerCount"
             placeholder="Passenger Count"
             min="1"
             max="10"
             required>

      <!-- Search Button -->
      <button type="submit" class="search-btn">SEARCH</button>
    </form>
  </div>

  <script src="javascript/home.js" defer></script>
  <script>
    // Announcement functions
    async function loadAnnouncements() {
      try {
        const response = await fetch('php/get_announcements.php');
        const data = await response.json();
        
        if (data.success && data.announcements.length > 0) {
          displayAnnouncements(data.announcements);
        }
      } catch (error) {
        console.error('Failed to load announcements:', error);
      }
    }

    function displayAnnouncements(announcements) {
      const banner = document.getElementById('announcementsBanner');
      const content = document.getElementById('announcementsContent');
      
      if (announcements.length === 0) {
        content.innerHTML = '<div class="no-announcements">No announcements at this time.</div>';
      } else {
        content.innerHTML = announcements.map(announcement => {
          const date = new Date(announcement.date);
          const formattedDate = date.toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });
          
          return `
            <div class="announcement-item">
              <div class="announcement-title">
                <span>${announcement.title}</span>
                <span class="announcement-date">${formattedDate}</span>
              </div>
              <p class="announcement-message">${announcement.message}</p>
            </div>
          `;
        }).join('');
      }
      
      // Show the banner if user hasn't closed it in this session
      if (sessionStorage.getItem('announcementsClosed') !== 'true') {
        banner.style.display = 'block';
      }
    }

    function closeAnnouncements() {
      const banner = document.getElementById('announcementsBanner');
      banner.style.display = 'none';
      sessionStorage.setItem('announcementsClosed', 'true');
    }

    // Load announcements when page loads
    document.addEventListener('DOMContentLoaded', () => {
      loadAnnouncements();
    });
  </script>
</body>
</html>